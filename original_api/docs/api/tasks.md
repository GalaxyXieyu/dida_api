# ä»»åŠ¡ç®¡ç†æ¥å£

> ğŸ“ **æ³¨æ„**: ä»»åŠ¡çš„æ‰€æœ‰å­—æ®µè¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [ä»»åŠ¡å­—æ®µè¯´æ˜æ–‡æ¡£](../models/tasks_field.md)

## ä»»åŠ¡åŒæ­¥æ¥å£

### åŸºæœ¬ä¿¡æ¯
- æ¥å£åç§°ï¼šæ‰¹é‡æ£€æŸ¥åŒæ­¥
- æ¥å£æè¿°ï¼šè·å–æ‰€æœ‰ä»»åŠ¡ã€é¡¹ç›®ã€æ ‡ç­¾ç­‰æ•°æ®çš„åŒæ­¥ä¿¡æ¯
- è¯·æ±‚æ–¹æ³•ï¼šGET
- è¯·æ±‚URLï¼š/batch/check/{checkPoint}
- è¯·æ±‚å‚æ•°æ ¼å¼ï¼šURLå‚æ•°

### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|---------|
| checkPoint | integer | æ˜¯ | åŒæ­¥æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰ | 1739430306600 |

### å“åº”æ•°æ®ç»“æ„
```json
{
  "checkPoint": 1739430306600,      // åŒæ­¥æ—¶é—´æˆ³
  "syncTaskBean": {                 // ä»»åŠ¡åŒæ­¥æ•°æ®
    "update": [],                   // æ›´æ–°çš„ä»»åŠ¡
    "delete": [],                   // åˆ é™¤çš„ä»»åŠ¡
    "add": [],                      // æ–°å¢çš„ä»»åŠ¡
    "empty": false                  // æ˜¯å¦ä¸ºç©º
  },
  "projectProfiles": [],            // é¡¹ç›®/æ¸…å•æ•°æ®
  "projectGroups": [],              // é¡¹ç›®ç»„æ•°æ®
  "filters": [],                    // è¿‡æ»¤å™¨æ•°æ®
  "tags": [],                       // æ ‡ç­¾æ•°æ®
  "syncTaskOrderBean": {            // ä»»åŠ¡æ’åºæ•°æ®
    "taskOrderByDate": {},          // æŒ‰æ—¥æœŸæ’åº
    "taskOrderByPriority": {},      // æŒ‰ä¼˜å…ˆçº§æ’åº
    "taskOrderByProject": {}        // æŒ‰é¡¹ç›®æ’åº
  }
}
```

### Pythonç¤ºä¾‹ä»£ç 
```python
from typing import Dict, List, Optional
from datetime import datetime
import requests
from dataclasses import dataclass

@dataclass
class TaskSync:
    """ä»»åŠ¡åŒæ­¥æ•°æ®ç»“æ„"""
    checkPoint: int
    tasks: List[Dict]
    projects: List[Dict]
    tags: List[Dict]

class DidaTaskProcessor:
    """æ»´ç­”æ¸…å•ä»»åŠ¡å¤„ç†å™¨"""
    
    def __init__(self, token: str):
        """
        åˆå§‹åŒ–ä»»åŠ¡å¤„ç†å™¨
        
        Args:
            token: è®¿é—®ä»¤ç‰Œ
        """
        self.token = token
        self.headers = {
            "Cookie": f"t={token}",
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
        }
        
    def get_all_data(self, checkpoint: int = 0) -> TaskSync:
        """
        è·å–æ‰€æœ‰åŒæ­¥æ•°æ®
        
        Args:
            checkpoint: åŒæ­¥æ—¶é—´æˆ³ï¼Œé»˜è®¤ä¸º0è¡¨ç¤ºè·å–æ‰€æœ‰æ•°æ®
            
        Returns:
            TaskSync: åŒæ­¥æ•°æ®å¯¹è±¡
            
        Raises:
            Exception: å½“ç½‘ç»œè¯·æ±‚å¤±è´¥æ—¶
        """
        url = f"https://dida365.com/api/v2/batch/check/{checkpoint}"
        
        try:
            response = requests.get(url, headers=self.headers)
            response.raise_for_status()
            data = response.json()
            
            return TaskSync(
                checkPoint=data["checkPoint"],
                tasks=data.get("syncTaskBean", {}).get("update", []),
                projects=data.get("projectProfiles", []),
                tags=data.get("tags", [])
            )
        except requests.exceptions.RequestException as e:
            raise Exception(f"è·å–æ•°æ®å¤±è´¥: {str(e)}")
```

### æ³¨æ„äº‹é¡¹
1. å¢é‡åŒæ­¥
   - è®°å½•æœ€ååŒæ­¥æ—¶é—´
   - åªè·å–å˜æ›´æ•°æ®
   - å‡å°‘æ•°æ®ä¼ è¾“é‡

2. æ•°æ®å¤„ç†
   - åˆå¹¶æœ¬åœ°æ•°æ®
   - å¤„ç†æ•°æ®å†²çª
   - ä¿æŒæ•°æ®ä¸€è‡´æ€§

3. æ€§èƒ½ä¼˜åŒ–
   - ä½¿ç”¨é€‚å½“çš„ç¼“å­˜ç­–ç•¥
   - æ‰¹é‡å¤„ç†æ•°æ®
   - ä¼˜åŒ–ç½‘ç»œè¯·æ±‚

## ä»»åŠ¡æ“ä½œæ¥å£

### 1. åˆ›å»ºä»»åŠ¡

#### åŸºæœ¬ä¿¡æ¯
- æ¥å£åç§°ï¼šåˆ›å»ºä»»åŠ¡
- è¯·æ±‚æ–¹æ³•ï¼šPOST
- è¯·æ±‚URLï¼š/api/v2/task
- è¯·æ±‚æ ¼å¼ï¼šapplication/json

#### è¯·æ±‚å‚æ•°
```python
{
    "title": "æµ‹è¯•ä»»åŠ¡",                                    # å¿…å¡«ï¼Œä»»åŠ¡æ ‡é¢˜
    "content": "ä»»åŠ¡æè¿°",                                  # å¯é€‰ï¼Œä»»åŠ¡æè¿°
    "project_name": "å·¥ä½œ",                                # å¯é€‰ï¼Œé¡¹ç›®åç§°ï¼ˆä¼šè‡ªåŠ¨è½¬æ¢ä¸ºprojectIdï¼‰
    "projectId": "4024428bac6d182ac68da936",             # å¯é€‰ï¼Œé¡¹ç›®IDï¼ˆå¦‚æœæä¾›äº†project_nameåˆ™ä¸éœ€è¦ï¼‰
    "priority": 3,                                        # å¯é€‰ï¼Œä¼˜å…ˆçº§(1-5)
    "startDate": "2024-02-20T09:00:00.000+0000",        # å¯é€‰ï¼Œå¼€å§‹æ—¶é—´
    "dueDate": "2024-02-20T18:00:00.000+0000",          # å¯é€‰ï¼Œæˆªæ­¢æ—¶é—´
    "tags": ["å·¥ä½œ", "é‡è¦"],                              # å¯é€‰ï¼Œæ ‡ç­¾åˆ—è¡¨
    "isAllDay": false,                                   # å¯é€‰ï¼Œæ˜¯å¦å…¨å¤©ä»»åŠ¡
    "items": [],                                         # å¯é€‰ï¼Œå­ä»»åŠ¡åˆ—è¡¨
    "reminders": []                                      # å¯é€‰ï¼Œæé†’æ—¶é—´åˆ—è¡¨
}
```

#### Pythonç¤ºä¾‹
```python
# åˆ›å»ºä»»åŠ¡
task = processor.add_task(
    title="æµ‹è¯•ä»»åŠ¡",
    project_name="å·¥ä½œ",  # è‡ªåŠ¨è½¬æ¢ä¸ºprojectId
    content="ä»»åŠ¡æè¿°",
    priority=3,
    tags=["å·¥ä½œ", "é‡è¦"]  # ç›´æ¥è®¾ç½®æ ‡ç­¾
)
```

### 2. æ›´æ–°ä»»åŠ¡

#### åŸºæœ¬ä¿¡æ¯
- æ¥å£åç§°ï¼šæ›´æ–°ä»»åŠ¡
- è¯·æ±‚æ–¹æ³•ï¼šPUT
- è¯·æ±‚URLï¼š/api/v2/task/{taskId}
- è¯·æ±‚æ ¼å¼ï¼šapplication/json

#### è¯·æ±‚å‚æ•°
```python
{
    "title": "æ›´æ–°åçš„æ ‡é¢˜",                               # å¯é€‰ï¼Œä»»åŠ¡æ ‡é¢˜
    "content": "æ›´æ–°åçš„æè¿°",                             # å¯é€‰ï¼Œä»»åŠ¡æè¿°
    "project_name": "ä¸ªäºº",                               # å¯é€‰ï¼Œç§»åŠ¨åˆ°å…¶ä»–é¡¹ç›®
    "priority": 5,                                       # å¯é€‰ï¼Œä¼˜å…ˆçº§
    "status": 2,                                        # å¯é€‰ï¼Œä»»åŠ¡çŠ¶æ€(0:å¾…åŠ, 2:å·²å®Œæˆ)
    "tags": ["ä¸ªäºº", "å­¦ä¹ "],                             # å¯é€‰ï¼Œè®¾ç½®æ–°æ ‡ç­¾ï¼ˆæ›¿æ¢ç°æœ‰æ ‡ç­¾ï¼‰
    "add_tags": ["ç´§æ€¥", "ä¼šè®®"],                         # å¯é€‰ï¼Œæ·»åŠ æ–°æ ‡ç­¾ï¼ˆä¿ç•™ç°æœ‰æ ‡ç­¾ï¼‰
    "remove_tags": ["ä¼šè®®"]                              # å¯é€‰ï¼Œç§»é™¤æŒ‡å®šæ ‡ç­¾
}
```

#### Pythonç¤ºä¾‹
```python
# æ›´æ–°ä»»åŠ¡
updated_task = processor.update_task(
    task_id="task123",
    project_name="ä¸ªäºº",     # ç§»åŠ¨åˆ°å…¶ä»–é¡¹ç›®
    title="æ–°æ ‡é¢˜",
    priority=5
)

# æ ‡ç­¾æ“ä½œ
task = processor.update_task(
    task_id="task123",
    add_tags=["ç´§æ€¥", "ä¼šè®®"],     # æ·»åŠ æ–°æ ‡ç­¾
    remove_tags=["å·¥ä½œ"]          # ç§»é™¤æ ‡ç­¾
)
```

### 3. åˆ é™¤ä»»åŠ¡

#### åŸºæœ¬ä¿¡æ¯
- æ¥å£åç§°ï¼šåˆ é™¤ä»»åŠ¡
- è¯·æ±‚æ–¹æ³•ï¼šDELETE
- è¯·æ±‚URLï¼š/api/v2/task/{taskId}

#### Pythonç¤ºä¾‹
```python
# åˆ é™¤ä»»åŠ¡
is_deleted = processor.delete_task(task_id="task123")
```

### 4. å®Œæˆä»»åŠ¡

#### åŸºæœ¬ä¿¡æ¯
- æ¥å£åç§°ï¼šå®Œæˆä»»åŠ¡
- è¯·æ±‚æ–¹æ³•ï¼šPUT
- è¯·æ±‚URLï¼š/api/v2/task/{taskId}

#### Pythonç¤ºä¾‹
```python
# å®Œæˆä»»åŠ¡
completed_task = processor.complete_task(task_id="task123")
```

### 5. æ‰¹é‡æ“ä½œ

#### æ‰¹é‡æ·»åŠ ä»»åŠ¡
```python
# æ‰¹é‡æ·»åŠ ä»»åŠ¡
tasks = [
    {
        "title": "ä»»åŠ¡1",
        "project_name": "å·¥ä½œ",
        "tags": ["é‡è¦"]
    },
    {
        "title": "ä»»åŠ¡2",
        "project_name": "ä¸ªäºº",
        "priority": 4
    }
]
results = processor.add_tasks(tasks)
```

#### æ‰¹é‡æ›´æ–°ä»»åŠ¡
```python
# æ‰¹é‡æ›´æ–°ä»»åŠ¡
updates = [
    {
        "id": "task123",
        "project_name": "å·¥ä½œ",
        "add_tags": ["ç´§æ€¥"]
    },
    {
        "id": "task456",
        "status": 2  # å®Œæˆä»»åŠ¡
    }
]
results = processor.update_tasks(updates)
```

#### æ‰¹é‡åˆ é™¤ä»»åŠ¡
```python
# æ‰¹é‡åˆ é™¤ä»»åŠ¡
task_ids = ["task123", "task456", "task789"]
success = processor.delete_tasks(task_ids)
```

#### æ‰¹é‡å®Œæˆä»»åŠ¡
```python
# æ‰¹é‡å®Œæˆä»»åŠ¡
task_ids = ["task123", "task456", "task789"]
results = processor.complete_tasks(task_ids)
```

## æ³¨æ„äº‹é¡¹

1. é¡¹ç›®æ“ä½œ
   - å¯ä»¥é€šè¿‡ `project_name` ç›´æ¥æŒ‡å®šé¡¹ç›®ï¼Œæ— éœ€æ‰‹åŠ¨æŸ¥æ‰¾é¡¹ç›®ID
   - ç§»åŠ¨ä»»åŠ¡åˆ°å…¶ä»–é¡¹ç›®åªéœ€åœ¨æ›´æ–°æ—¶æŒ‡å®š `project_name`

2. æ ‡ç­¾æ“ä½œ
   - ç›´æ¥è®¾ç½®æ ‡ç­¾ï¼šä½¿ç”¨ `tags` å‚æ•°ï¼ˆæ›¿æ¢ç°æœ‰æ ‡ç­¾ï¼‰
   - æ·»åŠ æ ‡ç­¾ï¼šä½¿ç”¨ `add_tags` å‚æ•°ï¼ˆä¿ç•™ç°æœ‰æ ‡ç­¾ï¼‰
   - ç§»é™¤æ ‡ç­¾ï¼šä½¿ç”¨ `remove_tags` å‚æ•°
   - æ ‡ç­¾æ“ä½œå¯ä»¥ä¸å…¶ä»–æ›´æ–°æ“ä½œåŒæ—¶è¿›è¡Œ

3. æ—¶é—´æ ¼å¼
   - æ‰€æœ‰æ—¶é—´å­—æ®µä½¿ç”¨ISO 8601æ ¼å¼
   - ç¤ºä¾‹ï¼š`"2024-02-20T09:00:00.000+0000"`

4. çŠ¶æ€è¯´æ˜
   - 0: å¾…åŠ
   - 2: å·²å®Œæˆ

5. ä¼˜å…ˆçº§è¯´æ˜
   - 1-5: å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜

6. é”™è¯¯å¤„ç†
   - 200: æ“ä½œæˆåŠŸ
   - 400: è¯·æ±‚å‚æ•°é”™è¯¯
   - 401: æœªæˆæƒ
   - 404: ä»»åŠ¡ä¸å­˜åœ¨

## æ‰¹é‡æ“ä½œä»»åŠ¡

### æ¥å£è¯´æ˜
- æ¥å£åœ°å€ï¼š`https://api.dida365.com/api/v2/batch/task`
- è¯·æ±‚æ–¹æ³•ï¼š`POST`
- åŠŸèƒ½è¯´æ˜ï¼šæ”¯æŒæ‰¹é‡æ·»åŠ ã€æ›´æ–°ã€åˆ é™¤ä»»åŠ¡åŠå…¶é™„ä»¶

### è¯·æ±‚å‚æ•°
è¯·æ±‚ä½“ä¸ºJSONå¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š

| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| add | array | æ˜¯ | éœ€è¦æ·»åŠ çš„ä»»åŠ¡åˆ—è¡¨ |
| update | array | æ˜¯ | éœ€è¦æ›´æ–°çš„ä»»åŠ¡åˆ—è¡¨ |
| delete | array | æ˜¯ | éœ€è¦åˆ é™¤çš„ä»»åŠ¡åˆ—è¡¨ |
| addAttachments | array | æ˜¯ | éœ€è¦æ·»åŠ çš„é™„ä»¶åˆ—è¡¨ |
| updateAttachments | array | æ˜¯ | éœ€è¦æ›´æ–°çš„é™„ä»¶åˆ—è¡¨ |
| deleteAttachments | array | æ˜¯ | éœ€è¦åˆ é™¤çš„é™„ä»¶åˆ—è¡¨ |

### ä»»åŠ¡å¯¹è±¡å­—æ®µè¯´æ˜
> ğŸ’¡ å®Œæ•´çš„å­—æ®µè¯´æ˜è¯·å‚è€ƒ [ä»»åŠ¡å­—æ®µè¯´æ˜æ–‡æ¡£](../models/tasks_field.md)

è¿™é‡Œä»…åˆ—å‡ºæœ€å¸¸ç”¨çš„å­—æ®µï¼š

#### æ ¸å¿ƒå­—æ®µ
| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|---------|
| id | string | æ˜¯ | ä»»åŠ¡å”¯ä¸€æ ‡è¯† | "67adb9ad266f556eed65b8f0" |
| title | string | æ˜¯ | ä»»åŠ¡æ ‡é¢˜ | "æµ‹è¯•å†…å®¹" |
| content | string | å¦ | ä»»åŠ¡å†…å®¹ | "ä»»åŠ¡è¯¦ç»†æè¿°" |
| projectId | string | æ˜¯ | æ‰€å±é¡¹ç›®ID | "4024428bac6d182ac68da936" |

#### æ—¶é—´ç›¸å…³å­—æ®µ
| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|---------|
| startDate | string | å¦ | å¼€å§‹æ—¶é—´ | "2025-02-13T10:00:00.000+0000" |
| dueDate | string | å¦ | æˆªæ­¢æ—¶é—´ | "2025-02-13T10:30:00.000+0000" |
| timeZone | string | å¦ | æ—¶åŒº | "Asia/Shanghai" |
| isAllDay | boolean | å¦ | æ˜¯å¦å…¨å¤©ä»»åŠ¡ | false |
| isFloating | boolean | å¦ | æ˜¯å¦æµ®åŠ¨ä»»åŠ¡ | false |

#### é‡å¤ä»»åŠ¡å­—æ®µ
| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|---------|
| repeatFlag | string | å¦ | é‡å¤è§„åˆ™ | "RRULE:FREQ=DAILY;INTERVAL=1" |
| repeatFirstDate | string | å¦ | é¦–æ¬¡é‡å¤æ—¥æœŸ | "2025-02-13T16:00:00.000+0000" |
| repeatFrom | string | å¦ | é‡å¤èµ·å§‹ç‚¹ | "2

